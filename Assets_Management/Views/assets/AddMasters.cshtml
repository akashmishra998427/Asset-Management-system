@{
    ViewData["Title"] = "Add Masters";
    Layout = "~/Views/Shared/ItLayout.cshtml";
}

<link rel="stylesheet" href="~/css/AssetRegistration.css" />
<style>
    .form-section {
         box-shadow: none !important;
     }
</style>

<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-12 col-xl-11">
            <div class="card">
                <div class="card-header">
                    <h3 class="mb-0">Add Master</h3>
                </div>
                <div class="card-body">
                     <form id="dynamicAssetForm">
                        <div class="form-section mt-4" style="border:none">
                            <div class="row">
                                 <div class="col-md-4 mb-3">
                                    <label for="assetTypeSelect" class="form-label">Select Asset Type</label>
                                    <select class="form-select" id="assetTypeSelect" name="assetType">
                                        <option value="C" selected>Computer</option>
                                        <option value="M">Monitor</option>
                                        <option value="L">Laptop</option>
                                        <option value="CPU">CPU</option>
                                        <option value="T">Tablet</option>
                                        <option value="V">TV</option>
                                        <option value="RP">Printer (Rented)</option>
                                        <option value="P">Printer</option>
                                        <option value="W">Switch</option>
                                        <option value="F">Firewall</option>
                                        <option value="B">Face Machine</option>
                                        <option value="Chair">Chair</option>
                                        <option value="RAM">RAM</option>
                                        <option value="HDD">HDD</option>
                                        <option value="AC">AC</option>
                                        <option value="Vehicle">Vehicle</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="Name" class="form-label required">Name</label>
                                    <input type="text" class="form-control" id="Name" name="Name" required />
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label for="MasterType" class="form-label required">Master&nbsp;Type</label>
                                    @* <input type="text" class="form-control" id="MasterType" name="MasterType" required /> *@
                                    <select id="ddlMakeModel" class="form-select" required>
                                        <option value="Make">Make</option>
                                        <option value="Model">Model</option>
                                    </select>
                                </div>
                                <div class="form-check form-switch col-md-1">
                                    <label for="Name" class="form-label required">Active</label>
                                    <input class="form-check-input" type="checkbox" id="Active" value="1">
                                    <label class="form-check-label" for="Active">On / Off</label>
                                </div>
                            </div> 
                        </div> 
                        <div class="d-flex justify-content-end mt-3 pb-3 ms-3">
                            <button type="button" class="btn btn-primary" onclick="AddMaster()"> Save </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
 
<script>
     let $toggle, $label;

    $(function () {
        $toggle = $('#activeToggle');
        $label  = $('#toggleLabel');
    });

    function toggleActive() {
        $toggle.toggleClass('inactive');

        const isInactive = $toggle.hasClass('inactive');
        $label.text(isInactive ? 'Inactive' : 'Active')
              .css('color', isInactive ? '#e74c3c' : '#27ae60')
              .attr('aria-checked', !isInactive);
    }
     
    function AddMaster() {

        const assetName = $('#Name').val().trim();
        if (!assetName) {
            alert("Please enter an asset name");
            return;
        }

        const payload = {
            Asset_Type: $('#assetTypeSelect').val(),
            Asset_Name: assetName,
            MAKE: $('#ddlMakeModel').val(),
            Active: $('#Active').is(':checked')
        };

        $.ajax({
            url: '/Assets/AddMaster',
            type: 'POST',
            data: JSON.stringify(payload),
            contentType: 'application/json; charset=utf-8',
            success: function (response) {
                if (response.success) {
                    fireSweetAlert(response.message,'success');
                    $('#assetTypeSelect').val('');
                    $('#Name').val('');
                    $('#ddlMakeModel').val('');
                    $('#Active').prop('checked', false);
                } else {
                    fireSweetAlert('Faild to save master','error');
                }
            },
            error: function (xhr) {
                let errMessage = "An error occurred";
                if (xhr.responseJSON && xhr.responseJSON.Message) {
                    errMessage = xhr.responseJSON.Message;
                }
                alert("Server error: " + errMessage);
            }
        });
    }
</script>
 
